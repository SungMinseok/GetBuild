# QuickBuild v2 - 스케줄 중심 UI 가이드

## 🎉 새로운 기능

### 전면 개편된 UI
- **메인 화면**: 스케줄 리스트 중심의 직관적인 인터페이스
- **카드형 레이아웃**: 각 스케줄을 시각적으로 명확하게 표시
- **실시간 로그**: 하단에 실행 로그 실시간 표시

### 강화된 스케줄 기능
1. **반복 설정**
   - 일회성 (Once)
   - 매일 반복 (Daily)
   - 주간 반복 (Weekly) - 특정 요일 선택 가능

2. **스케줄 관리**
   - 생성: 다이얼로그를 통한 상세 설정
   - 편집: 기존 스케줄 수정
   - 삭제: 확인 후 삭제
   - 활성화/비활성화: 체크박스로 간단 토글

3. **수동 실행**
   - 각 스케줄을 즉시 수동 실행 가능
   - 자동/수동 실행 모두 QThread로 백그라운드 처리

## 📁 파일 구조

```
GetBuild_clean/
├── index_v2.py              # 새 메인 UI
├── index.py                 # 기존 UI (백업 유지)
├── core/                    # 핵심 모듈
│   ├── scheduler.py         # 스케줄 관리 (확장됨)
│   ├── worker_thread.py     # QThread 작업 실행 (신규)
│   ├── config_manager.py
│   ├── build_operations.py
│   └── aws_manager.py
├── ui/                      # UI 컴포넌트 (신규)
│   ├── schedule_dialog.py   # 스케줄 생성/편집 다이얼로그
│   └── schedule_item_widget.py  # 스케줄 아이템 위젯
├── migrate_schedule.py      # 마이그레이션 스크립트
└── schedule.json            # 스케줄 데이터 (새 포맷)
```

## 🚀 시작하기

### 1. 마이그레이션 (기존 사용자)

기존 `schedule.json`을 새 포맷으로 변환:

```bash
python migrate_schedule.py
```

- 자동으로 백업 생성 (`schedule.json.backup_날짜시간`)
- 기존 스케줄에 새 필드 추가 (id, repeat_type 등)

### 2. 새 UI 실행

```bash
python index_v2.py
```

## 🎨 UI 사용법

### 메인 화면

```
┌─────────────────────────────────────────────────┐
│ 📅 스케줄 관리         ➕새스케줄  🔄새로고침 │
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌─────────────────────────────────────────┐   │
│  │ ☑ 매일 아침 빌드 테스트      08:00    │   │
│  │ 🔁 매일 반복 | 📦 game_dev              │   │
│  │ ⚙️ 테스트(로그)                         │   │
│  │                    ▶실행 ✏편집 🗑삭제   │   │
│  └─────────────────────────────────────────┘   │
│                                                 │
│  ┌─────────────────────────────────────────┐   │
│  │ ☑ 주간 서버 패치           10:00       │   │
│  │ 🔁 매주 월,수,금 | 📦 game_SEL         │   │
│  │ ⚙️ 서버패치 | 🌿 game                   │   │
│  │                    ▶실행 ✏편집 🗑삭제   │   │
│  └─────────────────────────────────────────┘   │
│                                                 │
├─────────────────────────────────────────────────┤
│ 📋 실행 로그                                    │
│ [14:30:00] 새 스케줄 생성: 테스트 스케줄      │
│ [14:30:15] [자동 실행] 매일 아침 빌드...     │
│ [14:30:20] ✅ 완료: 테스트 완료                │
└─────────────────────────────────────────────────┘
```

### 스케줄 생성 다이얼로그

**"➕ 새 스케줄" 클릭 시 표시**

```
┌──────────────────────────────────────────┐
│  스케줄 생성                              │
├──────────────────────────────────────────┤
│  [기본 정보]                              │
│  이름: ________________                  │
│  실행 시간: [14:00] ▼                    │
│  실행 옵션: [테스트(로그)] ▼             │
│  ☑ 활성화                                │
│                                          │
│  [반복 설정]                              │
│  ○ 일회성                                │
│  ○ 매일 반복                              │
│  ● 주간 반복 (특정 요일)                  │
│  반복 요일: ☑월 ☑화 ☐수 ☐목 ☑금 ☐토 ☐일 │
│                                          │
│  [빌드 설정]                              │
│  빌드명: [game_dev] ▼                    │
│                                          │
│  [AWS 설정]                               │
│  AWS URL: ____________________________   │
│  Branch: ____________                    │
│                                          │
│              [취소]    [생성]            │
└──────────────────────────────────────────┘
```

## 📝 스케줄 설정 예시

### 1. 매일 아침 테스트 빌드

```json
{
  "name": "매일 아침 테스트",
  "time": "08:00",
  "option": "테스트(로그)",
  "buildname": "game_dev",
  "repeat_type": "daily",
  "enabled": true
}
```

### 2. 주간 서버 패치 (월/수/금)

```json
{
  "name": "주간 서버 패치",
  "time": "10:00",
  "option": "서버패치",
  "buildname": "game_SEL",
  "awsurl": "https://awsdeploy.pbb-qa.pubg.io/environment/sel-game",
  "branch": "game",
  "repeat_type": "weekly",
  "repeat_days": [0, 2, 4],
  "enabled": true
}
```

### 3. 일회성 빌드 복사

```json
{
  "name": "긴급 빌드 복사",
  "time": "15:30",
  "option": "클라복사",
  "buildname": "game_hotfix",
  "repeat_type": "once",
  "enabled": true
}
```

## ⚙️ 실행 옵션

| 옵션 | 설명 | 필요 설정 |
|------|------|----------|
| 테스트(로그) | 로그만 출력 (테스트용) | 빌드명 |
| 클라복사 | 클라이언트 빌드 복사 | 빌드명 |
| 서버복사 | 서버 빌드 복사 | 빌드명 |
| 전체복사 | 전체 빌드 복사 | 빌드명 |
| 서버업로드 | 서버 빌드 AWS 업로드 | 빌드명, AWS URL, Branch |
| 서버패치 | AWS 서버 패치 | 빌드명, AWS URL, Branch |
| 서버업로드및패치 | 업로드 + 패치 | 빌드명, AWS URL, Branch |
| 빌드굽기 | TeamCity 빌드 실행 | Branch |

## 🔄 반복 설정 가이드

### 일회성 (Once)
- 한 번만 실행되고 자동으로 비활성화됩니다.
- 긴급 작업이나 1회성 테스트에 사용

### 매일 반복 (Daily)
- 매일 지정된 시간에 자동 실행
- 정기 빌드, 일일 테스트 등에 사용
- **주말 제외**: 토요일, 일요일은 자동 스킵

### 주간 반복 (Weekly)
- 선택한 요일에만 실행
- 요일 선택: 월(0), 화(1), 수(2), 목(3), 금(4), 토(5), 일(6)
- 예: 월/수/금 서버 패치, 화/목 테스트 등

## 🧵 QThread 백그라운드 실행

### 장점
1. **UI 블록킹 없음**: 작업 중에도 UI 조작 가능
2. **동시 실행**: 여러 스케줄 동시 실행 가능
3. **실시간 로그**: 작업 진행 상황 실시간 확인

### 작업 상태 확인
- 로그 영역에 실시간 표시
- 시작: `[자동 실행] 스케줄명 - HH:MM`
- 완료: `✅ 완료: 스케줄명 - 결과`
- 실패: `❌ 실패: 스케줄명 - 오류 메시지`

## 🔧 고급 설정

### schedule.json 직접 편집

```json
[
  {
    "id": "uuid-string",
    "name": "스케줄 이름",
    "time": "HH:MM",
    "option": "실행 옵션",
    "buildname": "빌드명",
    "awsurl": "AWS URL",
    "branch": "브랜치명",
    "repeat_type": "once|daily|weekly",
    "repeat_days": [0, 1, 2, 3, 4, 5, 6],
    "enabled": true,
    "created_at": "생성 시각"
  }
]
```

### 주의사항
- `id`: UUID 형식, 고유값 필수
- `time`: "HH:MM" 24시간 형식
- `repeat_days`: weekly일 때만 사용, 0=월 ~ 6=일
- `enabled`: false면 실행 안 됨

## 🐛 문제 해결

### Q: 스케줄이 실행되지 않아요
**A**: 다음을 확인하세요:
1. 스케줄이 활성화되어 있는지 (체크박스)
2. 주말이 아닌지 (토/일은 자동 스킵)
3. 시간 형식이 "HH:MM"인지
4. 로그에 오류 메시지가 있는지

### Q: 여러 스케줄이 같은 시간이에요
**A**: 정상입니다! 같은 시간에 여러 스케줄이 순차 실행됩니다.

### Q: 수동 실행과 자동 실행의 차이는?
**A**: 
- **자동 실행**: 시간 도달 시 자동 실행
- **수동 실행**: "▶실행" 버튼으로 즉시 실행
- 둘 다 QThread로 백그라운드 처리

### Q: 실행 중인 작업을 취소하려면?
**A**: 현재 버전에서는 취소 기능이 없습니다. 작업 완료를 기다리거나 프로그램을 종료하세요.

## 📊 기존 UI와 비교

| 기능 | 기존 UI (index.py) | 새 UI (index_v2.py) |
|------|-------------------|---------------------|
| 스케줄 표시 | 텍스트 리스트 | 카드형 UI |
| 반복 설정 | ✗ | ✓ (daily/weekly) |
| 스케줄 편집 | ✗ | ✓ |
| 백그라운드 실행 | ✗ | ✓ (QThread) |
| 실시간 로그 | ✓ | ✓ (개선됨) |
| UI 블록킹 | 있음 | 없음 |

## 🎯 권장 워크플로우

1. **초기 설정**
   ```bash
   python migrate_schedule.py  # 기존 스케줄 마이그레이션
   python index_v2.py          # 새 UI 실행
   ```

2. **스케줄 생성**
   - "➕ 새 스케줄" 클릭
   - 다이얼로그에서 상세 설정
   - 반복 유형 선택 (일회/매일/주간)
   - "생성" 클릭

3. **테스트**
   - "테스트(로그)" 옵션으로 스케줄 생성
   - "▶ 실행" 버튼으로 수동 테스트
   - 로그 확인

4. **실제 작업**
   - 테스트 완료 후 실제 옵션으로 변경
   - 활성화 체크
   - 자동 실행 대기 또는 수동 실행

## 📚 추가 자료

- 기존 UI: `index.py` (백업 유지)
- 리팩토링 문서: `README_REFACTORING.md`
- 스케줄 테스트 가이드: `SCHEDULE_TEST_GUIDE.md`

## 🔄 향후 개선 사항

- [ ] 작업 취소 기능
- [ ] 스케줄 복제 기능
- [ ] 스케줄 그룹화
- [ ] 실행 히스토리 기록
- [ ] 알림/이메일 발송
- [ ] 빌드 소스/로컬 경로 UI 설정

---

**QuickBuild v2** - 더 강력하고 직관적인 빌드 관리 도구

