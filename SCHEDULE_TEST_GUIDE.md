# 예약 스케줄 확장 기능 테스트 가이드

## 변경 사항 요약

### 1. 예약 스케줄 전면 확장 ✅
- **이전**: 단일 예약만 지원 (체크박스 + 시간 설정)
- **현재**: 여러 예약 동시 지원 (체크박스 + `schedule.json` 파일)
- **동작**: 매 분마다 `schedule.json`의 모든 스케줄을 확인하여 해당 시간에 실행

### 2. 테스트 옵션 추가 ✅
- **새 옵션**: "테스트(로그)"
- **기능**: 실제 작업 없이 로그만 출력
- **용도**: 예약이 제대로 작동하는지 확인

### 3. 스케줄 삭제 기능 ✅
- **새 버튼**: "스케쥴 전체삭제" (빨간색 버튼)
- **기능**: `schedule.json`의 모든 스케줄 삭제

---

## 테스트 시나리오

### 시나리오 1: 테스트(로그) 옵션으로 예약 테스트

**목적**: 예약 기능이 제대로 동작하는지 확인 (실제 작업 없음)

**단계**:

1. **테스트 스케줄 추가**
   ```json
   // schedule.json에 다음 추가 (현재 시간 + 2분 후로 설정)
   {
     "time": "14:35",  // 현재 시각보다 2분 후
     "option": "테스트(로그)",
     "buildname": "game_SEL",
     "awsurl": "https://test.example.com",
     "branch": "test_branch"
   }
   ```

2. **프로그램 실행**
   - `index.py` 실행

3. **2분 대기**
   - 설정한 시간이 되면 자동으로:
     - 콘솔에 로그 출력
     - 메시지 박스 팝업

4. **예상 결과**
   ```
   [예약실행] 스케줄 실행: 14:35 - 테스트(로그) | game_SEL
   [테스트 로그 출력]
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   실행 시각: 2025-10-26 14:35:00
   실행 옵션: 테스트(로그)
   빌드명: game_SEL
   ...
   ```

---

### 시나리오 2: 여러 예약 동시 실행

**목적**: 같은 시간에 여러 스케줄 실행 확인

**단계**:

1. **여러 테스트 스케줄 추가**
   ```json
   // schedule.json에 같은 시간으로 여러 개 추가
   [
     {
       "time": "14:40",
       "option": "테스트(로그)",
       "buildname": "game_SEL",
       "awsurl": "",
       "branch": ""
     },
     {
       "time": "14:40",
       "option": "테스트(로그)",
       "buildname": "game_dev",
       "awsurl": "",
       "branch": ""
     }
   ]
   ```

2. **프로그램 실행 및 대기**

3. **예상 결과**
   - 14:40에 두 개의 스케줄이 순차적으로 실행됨
   - 각각 로그와 메시지 박스가 표시됨

---

### 시나리오 3: 단일 예약(체크박스) + 다중 스케줄 동시 사용

**목적**: 기존 체크박스 예약과 schedule.json 예약이 모두 작동하는지 확인

**단계**:

1. **UI에서 단일 예약 설정**
   - 실행 옵션: "테스트(로그)"
   - 시간: 14:45
   - "예약 실행" 체크박스 체크

2. **schedule.json에도 같은 시간 추가**
   ```json
   {
     "time": "14:45",
     "option": "테스트(로그)",
     "buildname": "another_build",
     "awsurl": "",
     "branch": ""
   }
   ```

3. **예상 결과**
   - 14:45에 두 예약이 모두 실행됨
   - 체크박스가 자동으로 해제됨
   - 콘솔에 두 개의 실행 로그

---

### 시나리오 4: 주말 스킵 테스트

**목적**: 주말에는 예약이 실행되지 않는지 확인

**단계**:

1. **테스트 일자**: 토요일 또는 일요일
2. **예약 설정**: 현재 시간 + 2분
3. **예상 결과**: 아무 일도 일어나지 않음 (예약 스킵)

---

## 실제 작업 테스트 (주의!)

### 시나리오 5: 실제 빌드 복사 테스트

**⚠️ 주의**: 이 테스트는 실제 파일 복사를 수행합니다!

**단계**:

1. **테스트 스케줄 추가**
   ```json
   {
     "time": "15:00",
     "option": "클라복사",
     "buildname": "game_SEL",
     "awsurl": "",
     "branch": ""
   }
   ```

2. **사전 확인**
   - 빌드 소스 경로가 올바른지
   - 로컬 저장 경로에 충분한 공간이 있는지
   - 복사할 빌드가 존재하는지

3. **실행 및 모니터링**
   - 콘솔 로그 확인
   - 복사 진행률 팝업 확인

---

## 스케줄 관리

### 스케줄 등록
1. UI에서 시간, 옵션, 빌드명 등 설정
2. "스케쥴 등록" 버튼 클릭
3. `schedule.json` 파일에 자동 저장
4. 하단 텍스트 영역에서 확인

### 스케줄 확인
- 하단 텍스트 영역에 모든 스케줄 표시
- 포맷: `시간 | 옵션 | 빌드명 | AWS URL | Branch`

### 스케줄 삭제
1. "스케쥴 전체삭제" 버튼 클릭 (빨간색)
2. 확인 다이얼로그에서 Yes 선택
3. `schedule.json`의 모든 스케줄 삭제

---

## 디버깅 팁

### 콘솔 로그 확인
프로그램 실행 시 콘솔에 다음 로그가 출력됩니다:

```
[예약실행] 단일 예약 실행: 14:35 - 테스트(로그)
[예약실행] 스케줄 실행: 14:35 - 테스트(로그) | game_SEL
[예약실행 오류] {'time': '14:35', ...}: Error message
```

### schedule.json 직접 편집
- UTF-8 인코딩으로 저장
- JSON 포맷 확인 (온라인 JSON validator 사용 권장)
- 시간 포맷: "HH:MM" (예: "08:00", "14:35")

### 일반적인 문제

**문제**: 예약 시간이 되어도 실행 안 됨
- **확인사항**:
  1. 주말인지 확인 (주말은 자동 스킵)
  2. `schedule.json` 포맷 확인
  3. 시간 포맷이 "HH:MM"인지 확인
  4. 콘솔 로그에 오류 메시지 확인

**문제**: 여러 예약이 중복 실행됨
- **원인**: 체크박스 예약과 `schedule.json` 예약이 같은 시간
- **해결**: 의도한 동작이면 정상, 아니면 하나 삭제

---

## 기술 사항

### 실행 주기
- **체크 주기**: 1초마다 (`QTimer`, 1000ms)
- **중복 방지**: 같은 분에는 한 번만 실행

### 우선순위
1. 주말 체크 (토/일 자동 스킵)
2. 중복 실행 방지 (이미 실행한 분은 스킵)
3. 단일 예약 (체크박스) 실행
4. 다중 스케줄 (schedule.json) 순차 실행

### 스케줄 실행 시 동작
- 현재 UI 설정 저장
- 스케줄의 설정으로 UI 업데이트
- 작업 실행
- UI 설정 복원

---

## 예제 schedule.json

```json
[
  {
    "time": "08:00",
    "option": "테스트(로그)",
    "buildname": "game_SEL",
    "awsurl": "",
    "branch": ""
  },
  {
    "time": "09:00",
    "option": "클라복사",
    "buildname": "game_dev",
    "awsurl": "",
    "branch": ""
  },
  {
    "time": "10:00",
    "option": "서버업로드및패치",
    "buildname": "game_SEL",
    "awsurl": "https://awsdeploy.pbb-qa.pubg.io/environment/sel-game",
    "branch": "game"
  }
]
```

---

## 요약

✅ **완료된 작업**:
1. 여러 예약 동시 지원 (`schedule.json` 파일 기반)
2. 테스트 옵션 추가 ("테스트(로그)")
3. 스케줄 전체 삭제 버튼 추가
4. 기존 단일 예약과 호환

🎯 **권장 테스트 순서**:
1. "테스트(로그)" 옵션으로 단일 예약 테스트
2. "테스트(로그)" 옵션으로 여러 예약 동시 실행 테스트
3. 실제 작업 옵션으로 테스트 (주의!)

📝 **주의사항**:
- 주말에는 모든 예약이 자동으로 스킵됩니다
- 같은 분에 여러 예약이 있으면 순차적으로 실행됩니다
- 테스트는 "테스트(로그)" 옵션으로 먼저 해보세요!

